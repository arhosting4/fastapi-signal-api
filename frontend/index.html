<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScalpMaster AI - Live Signals</title>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Teko:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* (یہاں مکمل CSS کوڈ ہوگا - میں اسے نیچے الگ سے فراہم کر رہا ہوں) */
        /* Common Styles */
        :root { --bg-color: #0a0f1e; --primary-color: #1a233b; --secondary-color: #2a3858; --accent-color: #ffab00; --text-color: #e0e0e0; --buy-color: #00bfa5; --sell-color: #ff5252; }
        body { font-family: 'Roboto', sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 0; }
        .container { width: 95%; max-width: 1500px; margin: 0 auto; padding: 20px 0; }
        .glass-panel { background: rgba(26, 35, 59, 0.5); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; padding: 25px; box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37); }
        h2 { font-family: 'Teko', sans-serif; font-size: 1.8em; color: var(--accent-color); margin-top: 0; border-bottom: 1px solid var(--secondary-color); padding-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px 10px; text-align: left; border-bottom: 1px solid var(--secondary-color); }
        th { font-weight: 700; color: #fff; }
        .table-wrapper { overflow-x: auto; }
        
        /* Header & Nav */
        .header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background-color: var(--primary-color); }
        .header h1 { font-family: 'Teko', sans-serif; font-size: 2em; color: #fff; margin: 0; }
        .navbar a { color: var(--text-color); text-decoration: none; padding: 10px 15px; font-weight: 500; border-radius: 6px; transition: background-color 0.3s; }
        .navbar a:hover, .navbar a.active { background-color: var(--accent-color); color: var(--bg-color); }

        /* Main Content */
        .content-grid { display: grid; grid-template-columns: 1.8fr 1.2fr; gap: 20px; margin-top: 20px; }
        #chart-container { height: 500px; }
        .no-signals { text-align: center; padding: 50px; font-size: 1.2em; color: #888; }
        .signal-buy { color: var(--buy-color); font-weight: bold; }
        .signal-sell { color: var(--sell-color); font-weight: bold; }

        /* Responsive Design */
        @media (max-width: 992px) {
            .content-grid { grid-template-columns: 1fr; }
            .header { flex-direction: column; gap: 15px; }
        }
        @media (max-width: 576px) {
            .navbar { display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; }
            .navbar a { padding: 8px 10px; font-size: 0.9em; }
            th, td { padding: 8px 5px; font-size: 0.85em; }
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>SCALPMASTER AI</h1>
        <nav class="navbar">
            <a href="index.html" class="active">Live Signals</a>
            <a href="history.html">Trade History</a>
            <a href="news.html">Market News</a>
        </nav>
    </header>

    <div class="container">
        <div class="content-grid">
            <div class="glass-panel">
                <h2>Active Trading Signals</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Symbol</th>
                                <th>Timeframe</th>
                                <th>Signal</th>
                                <th>Entry Price</th>
                                <th>Take Profit</th>
                                <th>Stop Loss</th>
                                <th>Confidence</th>
                            </tr>
                        </thead>
                        <tbody id="signals-body"></tbody>
                    </table>
                </div>
                <div id="no-signals-message" class="no-signals" style="display: none;">
                    <p>AI is scanning the markets... Awaiting high-probability setups.</p>
                </div>
            </div>
            <div class="glass-panel" id="chart-panel">
                <h2>Market Chart</h2>
                <div id="chart-container"></div>
            </div>
        </div>
    </div>

    <script>
        // (یہاں مکمل جاوا اسکرپٹ کوڈ ہوگا - میں اسے نیچے الگ سے فراہم کر رہا ہوں)
        const chartContainer = document.getElementById('chart-container');
        const chart = LightweightCharts.createChart(chartContainer, { /* ... chart options ... */ });
        const candleSeries = chart.addCandlestickSeries({ /* ... series options ... */ });
        let currentSymbol = 'XAU/USD';

        async function fetchAndUpdateChart(symbol, timeframe) { /* ... function code ... */ }
        async function fetchActiveSignals() {
            const response = await fetch('/api/active-signals');
            const signals = await response.json();
            const signalsBody = document.getElementById('signals-body');
            const noSignalsMessage = document.getElementById('no-signals-message');
            
            signalsBody.innerHTML = '';
            if (signals.length > 0) {
                noSignalsMessage.style.display = 'none';
                signals.forEach(signal => {
                    const row = document.createElement('tr');
                    row.onclick = () => fetchAndUpdateChart(signal.symbol, signal.timeframe);
                    row.innerHTML = `
                        <td><strong>${signal.symbol}</strong></td>
                        <td>${signal.timeframe}</td>
                        <td class="signal-${signal.signal.toLowerCase()}">${signal.signal.toUpperCase()}</td>
                        <td>${signal.price.toFixed(4)}</td>
                        <td>${signal.tp.toFixed(4)}</td>
                        <td>${signal.sl.toFixed(4)}</td>
                        <td>${signal.confidence.toFixed(2)}%</td>
                    `;
                    signalsBody.appendChild(row);
                });
                if (signals[0].symbol !== currentSymbol) {
                    fetchAndUpdateChart(signals[0].symbol, signals[0].timeframe);
                }
            } else {
                noSignalsMessage.style.display = 'block';
            }
        }
        
        // Initial & Interval Calls
        fetchActiveSignals();
        fetchAndUpdateChart('XAU/USD', '5m');
        setInterval(fetchActiveSignals, 30000);
        window.addEventListener('resize', () => chart.resize(chartContainer.clientWidth, chartContainer.clientHeight));
    </script>
</body>
</html>
```*(نوٹ: میں نے جگہ بچانے کے لیے اوپر CSS اور JS کو مختصر کیا ہے، لیکن آپ کو مکمل کوڈ فراہم کروں گا)*

---

### **مرحلہ 2: `history.html` (ٹریڈ ہسٹری کا نیا صفحہ)**

یہ صفحہ ڈیٹا بیس سے مکمل شدہ ٹریڈز کو ایک صاف ستھرے ٹیبل میں دکھائے گا۔

**`history.html` کا حتمی کوڈ:**
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScalpMaster AI - Trade History</title>
    <!-- (یہاں وہی CSS اور فونٹس ہوں گے جو index.html میں ہیں) -->
    <style>
        /* (وہی مشترکہ CSS کوڈ) */
        .outcome-tp { color: var(--buy-color); }
        .outcome-sl { color: var(--sell-color); }
    </style>
</head>
<body>
    <header class="header">
        <h1>SCALPMASTER AI</h1>
        <nav class="navbar">
            <a href="index.html">Live Signals</a>
            <a href="history.html" class="active">Trade History</a>
            <a href="news.html">Market News</a>
        </nav>
    </header>

    <div class="container">
        <div class="glass-panel">
            <h2>Completed Trades</h2>
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Symbol</th>
                            <th>Signal</th>
                            <th>Entry Price</th>
                            <th>Close Price</th>
                            <th>Outcome</th>
                            <th>Entry Time</th>
                            <th>Close Time</th>
                        </tr>
                    </thead>
                    <tbody id="history-body"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        async function fetchTradeHistory() {
            const response = await fetch('/api/completed-trades');
            const trades = await response.json();
            const historyBody = document.getElementById('history-body');
            historyBody.innerHTML = '';
            trades.forEach(trade => {
                const row = document.createElement('tr');
                const outcomeClass = trade.outcome === 'tp_hit' ? 'outcome-tp' : 'outcome-sl';
                row.innerHTML = `
                    <td><strong>${trade.symbol}</strong></td>
                    <td>${trade.signal.toUpperCase()}</td>
                    <td>${trade.entry_price.toFixed(4)}</td>
                    <td>${trade.close_price.toFixed(4)}</td>
                    <td class="${outcomeClass}">${trade.outcome.replace('_', ' ').toUpperCase()}</td>
                    <td>${new Date(trade.entry_time).toLocaleString()}</td>
                    <td>${new Date(trade.close_time).toLocaleString()}</td>
                `;
                historyBody.appendChild(row);
            });
        }
        fetchTradeHistory();
    </script>
</body>
</html>
