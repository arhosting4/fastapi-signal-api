# render.yaml
python:
  version: 3.11.6 # Python version you are using
services:
  - type: web
    name: signal-api
    runtime: python
    repo: https://github.com/arhosting4/fastapi-signal-api
    branch: main
    # UPDATED: More robust buildCommand for TA-Lib C library
    buildCommand: |
      apt-get update -y
      apt-get install -y build-essential wget
      wget http://prdownloads.sourceforge.net/ta-lib/ta-lib-0.4.0-src.tar.gz
      tar -xzf ta-lib-0.4.0-src.tar.gz
      cd ta-lib/
      ./configure --prefix=/usr
      make
      make install
      pip install -r requirements.txt
    startCommand: "gunicorn -w 4 -k uvicorn.workers.UvicornWorker app:app --bind 0.0.0.0:$PORT"
    envVars:
      - key: TELEGRAM_BOT_TOKEN
        sync: false
      - key: TELEGRAM_CHAT_ID
        sync: false
      - key: ALPHA_VANTAGE_API_KEY
        sync: false
    autoDeploy: true
    region: oregon
